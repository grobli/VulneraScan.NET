using VulneraNet.Core.Domain;
using VulneraNet.Core.Domain.NuGet.Vulnerabilities;

namespace VulneraNet.Core.Mappers;

public static class VulnerabilityEntryMapper
{
    public static Vulnerability ToVulnerability(this VulnerabilityEntry vulnerabilityEntry)
    {
        var versionRange = VersionRange.Parse(vulnerabilityEntry.Versions);
        var severity = (Severity)vulnerabilityEntry.Severity;
        return new Vulnerability(vulnerabilityEntry.Url, severity, versionRange);
    }
}